<!DOCTYPE html>
<html>
<head>
    <title>TensorFlow.js Hello World</title>
    <!-- Load TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.20.0"></script>
</head>
<body>
<h1>Hello TensorFlow.js ðŸ‘‹</h1>
<p>Check the browser console for output.</p>

<script>
    // Step 1: Create tensors
    const a = tf.scalar(5);
    const b = tf.scalar(3);

    // Step 2: Add them
    const c = a.add(b);

    // Step 3: Print result
    c.print(); // prints "Tensor 8"

    // Step 4: Simple linear model example (y = 2x + 1)
    const model = tf.sequential(); // why use sequential? a. it's a simple model. b. it's a linear model. c. it's a single input and output. d. it's a single hidden layer.
    model.add(tf.layers.dense({units: 1, inputShape: [1]})); //  units is the number of output units in the layer. b. inputShape is the shape of the input data.

    // Compile the model
    model.compile({loss: 'meanSquaredError', optimizer: 'sgd'});//Stochastic Gradient Descent (SGD), SGD means: â€œTake small random steps downhill to reduce error.â€ a. it's a regression problem. b. it's a continuous output. c. it's a single output. d. it's a single input. e. it's a single hidden layer. f. it's a single output unit. g. it's a single input unit. h. it's a single hidden layer. i. it's a single output unit. j. it's a single input unit. k. it's a single hidden layer. l
/*Mean Squared Error (MSE) is a fundamental concept in statistics and machine learning, playing a crucial role in assessing the accuracy of predictive models.
The MSE value provides a way to analyze the accuracy of the model.
It measures the average squared difference between predicted values and the actual values in the dataset.
It is calculated by taking the average of the squared residuals, where the residual is the difference between the predicted value and the actual value for each data point.*/

    // Prepare training data
    const xs = tf.tensor2d([1, 2, 3, 4], [4, 1]);
    const ys = tf.tensor2d([3, 5, 7, 9], [4, 1]); // y = 2x + 1

    // Train model
    async function train() {
        await model.fit(xs, ys, {epochs: 250, callbacks: {onEpochEnd: (epoch, logs) => console.log(`Epoch ${epoch}: loss = ${logs.loss}`)}});
        console.log("âœ… Training complete!"); // a. loss is the difference between the predicted value and the actual value. b. the lower the loss, the better the model. c. the goal is to minimize the loss.

        // Predict a new value
        const output = model.predict(tf.tensor2d([10], [1, 1])); // explain? a. predict the value of y when x is 5. b. the output is a tensor. c. the value of the tensor is the predicted value of y.
        output.print(); // should be close to 11
    }

    train();
</script>
</body>
</html>
